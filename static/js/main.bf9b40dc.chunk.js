(this.webpackJsonpkaupunkifillari=this.webpackJsonpkaupunkifillari||[]).push([[0],{117:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(30),i=n.n(o),c=n(10),s=n(16),l=n(49),u=n(156),f=n(157),d=n(79),b=n.n(d),j=n(58),v={},O=Object(a.createContext)(v),p=O.Provider,m=function(){var e=Object(a.useContext)(O);if(e===v)throw new Error("RootStore Consumer present without provider! This likely implies mistake in code, make sure that you have provider somewhere lower in the component tree (usually at or near app.tsx).");return e},h=n(2),x=Object(j.a)((function(){var e=m().stations,t=Object(a.useState)(),n=Object(c.a)(t,2),r=n[0],o=n[1];if(r)return Object(h.jsx)(s.a,{to:"station/".concat(r)});return Object(h.jsxs)("div",{className:b.a.container,children:[Object(h.jsx)("h1",{style:{color:"azure",textAlign:"center"},children:"Kaupunkifillarit"}),Object(h.jsx)(u.a,{disablePortal:!0,onChange:function(e){return o(e.target.textContent)},id:"combo-box-demo",options:e.map((function(e){return e.name})).filter((function(e,t,n){return n.indexOf(e)===t})),sx:{width:300,background:"azure"},renderInput:function(e){return Object(h.jsx)(f.a,Object(l.a)(Object(l.a)({},e),{},{label:"Valitse polkupy\xf6r\xe4asema"}))}})]})})),k=n(47),S=n(83),y=n.n(S),g=n(15),N=n(71),w=Object(j.a)((function(){var e=Object(a.useState)(),t=Object(c.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)(!1),i=Object(c.a)(o,2),l=i[0],u=i[1],f=m(),d=f.addFavorite,b=f.delFavorite,j=Object(a.useState)(Object(g.b)(m())),v=Object(c.a)(j,2),O=v[0],p=v[1];Object(g.c)(m(),(function(e){return p(e)}));var x=Object(s.g)().stationName;Object(a.useEffect)((function(){console.info("stationInfo ue running ..."),console.info(O.favorites);var e=O.stations.find((function(e){return e.name===x}));if(r(e),n){var t=O.favorites.find((function(e){return e.favoriteName===n.name}));u(!!t)}}),[O.favorites,O.stations,n,x]);return n?Object(h.jsxs)("div",{className:y.a.container,children:[Object(h.jsx)("h1",{style:{color:"azure"},children:n.name}),Object(h.jsx)("i",{onClick:function(){return function(){if(n){var e=O.favorites.find((function(e){return e.favoriteName===n.name}));u(!e),e?b(n.name):d(n.name)}}()},children:l?Object(h.jsx)(N.b,{size:"28",color:"yellow"}):Object(h.jsx)(N.a,{size:"28"})}),Object(h.jsxs)("p",{style:n.bikesAvailable<1?{color:"red"}:{color:"snow"},children:["Fillareita vapaana ",n.bikesAvailable]}),Object(h.jsxs)("p",{style:n.active?{color:"greenyellow"}:{color:"red"},children:["Asema ",n.active?"on k\xe4yt\xf6ss\xe4":"ei ole k\xe4yt\xf6ss\xe4"]}),Object(h.jsx)("button",{children:Object(h.jsx)(k.b,{to:"/",children:" Valitse toinen asema "})})]}):Object(h.jsx)("div",{children:Object(h.jsx)("p",{children:"NO_DATA"})})})),T=n(84),E=n.n(T),A=n(70),C=n.n(A),F=g.d.model("Station",{id:g.d.string,lat:g.d.number,lon:g.d.number,name:g.d.string,bikesAvailable:g.d.number,spacesAvailable:g.d.number,active:g.d.boolean}),I=(g.d.model("Stations",{bikeRentalStations:g.d.array(F)}),g.d.model("Favorite",{favoriteName:g.d.maybe(g.d.string)})),R=g.d.model("Root",{stations:g.d.array(F),favorites:g.d.array(I)}).actions((function(e){return{addFavorite:function(t){e.favorites.find((function(e){return e.favoriteName===t}))?console.info(t,"is allready in favorites"):(e.favorites.push({favoriteName:t}),console.log("favorite added"))},delFavorite:function(t){e.favorites.find((function(e){return e.favoriteName===t}))?(e.favorites.replace(e.favorites.filter((function(e){return e.favoriteName!==t}))),console.log("favorite deleted")):console.info(t,"is not part of favoritelist")},fetchStationDataAsync:Object(g.a)(C.a.mark((function t(){var n,a,r;return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("https://us-central1-kaupunkifillarit-aed04.cloudfunctions.net/api/getStations",{method:"GET",headers:{"Content-Type":"application/json"}});case 3:return n=t.sent,t.next=6,n.text();case 6:if(a=t.sent,r=JSON.parse(a),!n.ok){t.next=11;break}return e.stations.replace(r.bikeRentalStations),t.abrupt("return");case 11:console.error("NOTHING TO FETCH"),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(0),console.error("MST:",t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})))}})),_="ROOT_STORE",J=function(e){var t=e.children,n=m().fetchStationDataAsync;return Object(a.useEffect)((function(){console.log("USEEFFECT"),n();var e=setInterval((function(){console.info("Updating data..."),n()}),6e4);return function(){return clearInterval(e)}}),[n]),Object(h.jsx)("div",{children:t})},z=function(){var e=Object(a.useState)(),t=Object(c.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){r(function(){var e,t,n=g.d.snapshotProcessor(R,{postProcessor:function(e){var t=Object(l.a)({},e);return delete t.Stations,t}});try{var a;t=JSON.parse(null!==(a=localStorage.getItem(_))&&void 0!==a?a:"{}"),e=n.create(t)}catch(r){console.error("MST ERROR:",r),e=n.create()}return Object(g.c)(e,(function(e){return localStorage.setItem(_,JSON.stringify(e))})),e}())}),[]),n?Object(h.jsx)(p,{value:n,children:Object(h.jsx)(J,{children:Object(h.jsx)("div",{className:E.a.container,children:Object(h.jsxs)(s.d,{children:[Object(h.jsx)(s.b,{exact:!0,path:"/",component:x}),Object(h.jsx)(s.b,{exact:!0,path:"/station/:stationName",component:w})]})})})}):null};i.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(k.a,{children:Object(h.jsx)(z,{})})}),document.getElementById("root"))},79:function(e,t,n){},83:function(e,t,n){e.exports={container:"stationInfo_container__3H6VT"}},84:function(e,t,n){e.exports={container:"App_container__eSJ6i"}}},[[117,1,2]]]);
//# sourceMappingURL=main.bf9b40dc.chunk.js.map