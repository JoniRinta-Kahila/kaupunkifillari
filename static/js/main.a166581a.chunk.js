(this.webpackJsonpkaupunkifillari=this.webpackJsonpkaupunkifillari||[]).push([[0],{100:function(e,t,n){e.exports={container:"App_container__eSJ6i"}},136:function(e,t,n){"use strict";n.r(t);var a,r=n(0),i=n.n(r),c=n(36),o=n.n(c),s=n(10),l=n(18),u=n(17),d={},b=Object(r.createContext)(d),j=b.Provider,f=function(){var e=Object(r.useContext)(b);if(e===d)throw new Error("RootStore Consumer present without provider! This likely implies mistake in code, make sure that you have provider somewhere lower in the component tree (usually at or near app.tsx).");return e},O=n(48),p=n(1),v=function(){var e=Object(r.useState)([]),t=Object(s.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)(Object(u.b)(f())),c=Object(s.a)(i,2),o=c[0],d=c[1];return Object(u.c)(f(),(function(e){return d(e)})),Object(r.useEffect)((function(){var e=o.stations.filter((function(e){var t=o.favorites.find((function(t){return t.name===e.name}));return e.name===(null===t||void 0===t?void 0:t.name)}));a(e)}),[o]),o.favorites.length>1?Object(p.jsx)("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",width:"300px",margin:"8px"},children:n.map((function(e){return Object(p.jsx)("div",{style:{background:"azure",width:"fit-content",padding:"3px 5px",borderRadius:"5px",margin:"5px"},children:Object(p.jsx)(O.b,{style:{color:"black",textDecoration:"none",fontSize:"20px"},to:"station/".concat(e.id),children:"".concat(e.name,": ").concat(e.bikesAvailable)})})}))}):1===o.favorites.length?Object(p.jsx)(l.a,{to:"station/".concat(o.favorites[0].id)}):null},m=n(52),x=n(175),h=n(176),y=n(96),k=n.n(y),S=n(73),g=Object(S.a)((function(e){var t=e.displayHeader,n=void 0===t||t,a=f().stations,i=Object(r.useState)(),c=Object(s.a)(i,2),o=c[0],u=c[1];if(o)return Object(p.jsx)(l.a,{to:"/station/".concat(o)});return Object(p.jsxs)("div",{className:k.a.container,children:[n?Object(p.jsx)("h1",{style:{color:"azure",textAlign:"center"},children:"Kaupunkifillarit"}):null,Object(p.jsx)(x.a,{renderOption:function(e,t,n){return Object(r.createElement)("li",Object(m.a)(Object(m.a)({},e),{},{key:t.id}),t.name)},disablePortal:!0,onChange:function(e,t){return u(null===t||void 0===t?void 0:t.id)},getOptionLabel:function(e){return e.name},id:"combo-box-demo",options:a.map((function(e){return e})).filter((function(e,t,n){return n.indexOf(e)===t})),sx:{width:300,background:"azure"},renderInput:function(e){return Object(p.jsx)(h.a,Object(m.a)(Object(m.a)({},e),{},{label:"Valitse polkupy\xf6r\xe4asema"}))}})]})})),A=function(){return Object(p.jsxs)("div",{children:[Object(p.jsx)(g,{}),Object(p.jsx)(v,{})]})},w=n(99),I=n.n(w),E=n(86),R=Object(S.a)((function(){var e=Object(r.useState)(),t=Object(s.a)(e,2),n=t[0],a=t[1],i=Object(r.useState)(!1),c=Object(s.a)(i,2),o=c[0],d=c[1],b=f(),j=b.addFavorite,v=b.delFavorite,m=Object(r.useState)(Object(u.b)(f())),x=Object(s.a)(m,2),h=x[0],y=x[1];Object(u.c)(f(),(function(e){return y(e)}));var k=Object(l.g)().stationId;Object(r.useEffect)((function(){var e=h.stations.find((function(e){return e.id===k}));if(a(e),n){var t=h.favorites.find((function(e){return e.name===n.name}));d(!!t)}}),[h.favorites,h.stations,n,k]);var S=function(){return h.favorites.length<2?Object(p.jsx)(g,{displayHeader:!1}):Object(p.jsx)("button",{children:Object(p.jsx)(O.b,{to:"/",children:"Valitse toinen asemat"})})};return n?Object(p.jsxs)("div",{className:I.a.container,children:[Object(p.jsxs)("span",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(p.jsx)("h1",{style:{color:"azure"},children:n.name}),Object(p.jsx)("i",{onClick:function(){return function(){if(n){var e=h.favorites.find((function(e){return e.name===n.name}));d(!e),e?v(n):j(n)}}()},children:o?Object(p.jsx)(E.b,{size:"32",color:"yellow"}):Object(p.jsx)(E.a,{size:"32"})})]}),Object(p.jsxs)("div",{children:[Object(p.jsxs)("p",{style:n.bikesAvailable<1?{color:"red"}:{color:"snow"},children:["Fillareita vapaana ",n.bikesAvailable]}),Object(p.jsxs)("p",{style:n.active?{color:"greenyellow"}:{color:"red"},children:["Asema ",n.active?"on k\xe4yt\xf6ss\xe4":"ei ole k\xe4yt\xf6ss\xe4"]}),Object(p.jsx)(S,{})]})]}):Object(p.jsx)("div",{children:Object(p.jsx)("p",{children:"NO_DATA"})})})),z=n(100),F=n.n(z),D=n(14),_=n.n(D),C=n(101),T=n(102),N=n(87),P=n(67),H={apiKey:"AIzaSyA0zZzBan7E3YmvAon4l4h7ZOA9hamvlHE",authDomain:"kaupunkifillarit-aed04.firebaseapp.com",projectId:"kaupunkifillarit-aed04",storageBucket:"kaupunkifillarit-aed04.appspot.com",messagingSenderId:"746873844238",appId:"1:746873844238:web:33ffbe49354f2cb420825f",measurementId:"G-S8P5Z3F6S5"},J={getFunctionsInstance:function(){var e=(a||(a=Object(T.a)(H)),Object(N.b)(a,{provider:new N.a("6LdyvQYdAAAAAKZD7R1vWhl5PrCyfhHS4zaa6dii"),isTokenAutoRefreshEnabled:!0}));return Object(P.a)(e.app)}},Z=u.d.model("Station",{id:u.d.string,lat:u.d.number,lon:u.d.number,name:u.d.string,bikesAvailable:u.d.number,spacesAvailable:u.d.number,active:u.d.boolean}),B=(u.d.model("Stations",{bikeRentalStations:u.d.array(Z)}),u.d.model("Root",{stations:u.d.array(Z),favorites:u.d.array(Z)}).actions((function(e){return{addFavorite:function(t){e.favorites.find((function(e){return e.name===t.name}))?console.info(t.name,"is allready in favorites"):e.favorites.push(t)},delFavorite:function(t){e.favorites.find((function(e){return e.name===t.name}))?e.favorites.replace(e.favorites.filter((function(e){return e.name!==t.name}))):console.info(t.name,"is not part of favoritelist")},fetchStationDataAsync:Object(u.a)(_.a.mark((function t(){var n,a,r,i;return _.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=J.getFunctionsInstance(),a=C.a(n,"",{timeout:7e4}),r=a().then((function(e){return e})),t.next=5,r;case 5:i=t.sent.data,console.log(i),e.stations.replace(i.bikeRentalStations);case 8:case"end":return t.stop()}}),t)})))}}))),K="ROOT_STORE",V=function(e){var t=e.updateFrequency,n=void 0===t?12e4:t,a=e.children,i=f().fetchStationDataAsync;return Object(r.useEffect)((function(){i();var e=setInterval((function(){console.info("Updating data..."),i()}),n);return function(){return clearInterval(e)}}),[i,n]),Object(p.jsx)("div",{children:a})},L=function(){var e=Object(r.useState)(),t=Object(s.a)(e,2),n=t[0],a=t[1];return Object(r.useEffect)((function(){a(function(){var e,t,n=u.d.snapshotProcessor(B,{postProcessor:function(e){var t=Object(m.a)({},e);return delete t.Stations,t}});try{var a;t=JSON.parse(null!==(a=localStorage.getItem(K))&&void 0!==a?a:"{}"),e=n.create(t)}catch(r){console.error("MST ERROR:",r),e=n.create()}return Object(u.c)(e,(function(e){return localStorage.setItem(K,JSON.stringify(e))})),e}())}),[]),n?Object(p.jsx)(j,{value:n,children:Object(p.jsx)(V,{children:Object(p.jsx)("div",{className:F.a.container,children:Object(p.jsxs)(l.d,{children:[Object(p.jsx)(l.b,{exact:!0,path:"/",component:A}),Object(p.jsx)(l.b,{exact:!0,path:"/search",component:g}),Object(p.jsx)(l.b,{exact:!0,path:"/station/:stationId",component:R})]})})})}):null};o.a.render(Object(p.jsx)(i.a.StrictMode,{children:Object(p.jsx)(O.a,{children:Object(p.jsx)(L,{})})}),document.getElementById("root"))},96:function(e,t,n){},99:function(e,t,n){e.exports={container:"stationInfo_container__3H6VT"}}},[[136,1,2]]]);
//# sourceMappingURL=main.a166581a.chunk.js.map