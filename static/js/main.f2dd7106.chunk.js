(this.webpackJsonpkaupunkifillari=this.webpackJsonpkaupunkifillari||[]).push([[0],{111:function(e,t,n){},113:function(e,t,n){e.exports={container:"App_container__eSJ6i"}},152:function(e,t,n){"use strict";n.r(t);var a,i=n(1),c=n.n(i),r=n(42),o=n.n(r),s=n(10),l=n(19),u=n(17),j={},b=Object(i.createContext)(j),d=b.Provider,f=function(){var e=Object(i.useContext)(b);if(e===j)throw new Error("RootStore Consumer present without provider! This likely implies mistake in code, make sure that you have provider somewhere lower in the component tree (usually at or near app.tsx).");return e},O=n(31),h=n(2),x=function(){var e=Object(i.useState)([]),t=Object(s.a)(e,2),n=t[0],a=t[1],c=Object(i.useState)(Object(u.b)(f())),r=Object(s.a)(c,2),o=r[0],j=r[1];return Object(u.c)(f(),(function(e){return j(e)})),Object(i.useEffect)((function(){var e=o.stations.filter((function(e){var t=o.favorites.find((function(t){return t.name===e.name}));return e.name===(null===t||void 0===t?void 0:t.name)}));a(e)}),[o]),o.favorites.length>1?Object(h.jsx)("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",width:"300px",margin:"8px"},children:n.map((function(e){return Object(h.jsx)("div",{style:{background:"azure",width:"fit-content",padding:"3px 5px",borderRadius:"5px",margin:"5px"},children:Object(h.jsx)(O.b,{style:{color:"black",textDecoration:"none",fontSize:"20px"},to:"station/".concat(e.id),children:"".concat(e.name,": ").concat(e.bikesAvailable)})},e.id)}))}):1===o.favorites.length?Object(h.jsx)(l.a,{to:"station/".concat(o.favorites[0].id)}):null},p=n(39),m=n(199),v=n(200),_=n(111),g=n.n(_),k=n(64),S=Object(k.a)((function(e){var t=e.displayHeader,n=void 0===t||t,a=f().stations,c=Object(i.useState)(),r=Object(s.a)(c,2),o=r[0],u=r[1];if(o)return Object(h.jsx)(l.a,{to:"/station/".concat(o)});return Object(h.jsxs)("div",{className:g.a.container,children:[n?Object(h.jsx)("h1",{style:{color:"azure",textAlign:"center"},children:"Omat kaupunkifillarit"}):null,Object(h.jsx)(m.a,{renderOption:function(e,t,n){return Object(i.createElement)("li",Object(p.a)(Object(p.a)({},e),{},{key:t.id}),t.name)},disablePortal:!0,onChange:function(e,t){return u(null===t||void 0===t?void 0:t.id)},getOptionLabel:function(e){return e.name},id:"combo-box-demo",options:a.map((function(e){return e})).filter((function(e,t,n){return n.indexOf(e)===t})),sx:{width:300,background:"azure"},renderInput:function(e){return Object(h.jsx)(v.a,Object(p.a)(Object(p.a)({},e),{},{label:"Valitse polkupy\xf6r\xe4asema"}))}})]})})),y=n.p+"static/media/fillari192.9d853bc1.png",L=n(78),A=n.n(L),I=Object(i.createContext)(void 0),w=function(e){var t=e.children,n=Object(i.useState)(),a=Object(s.a)(n,2),c=a[0],r=a[1];return Object(i.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(e){r({lat:e.coords.latitude,lon:e.coords.longitude})}))}),[]),Object(h.jsx)(I.Provider,{value:{location:c},children:t})},N=function(e,t){var n=function(e){return e*(180/Math.PI)},a=e.lat,i=t.lat,c=e.lon,r=t.lon,o=n(a),s=n(i),l=n(i-a),u=n(r-c),j=Math.sin(l/2)*Math.sin(l/2)+Math.cos(o)*Math.cos(s)*Math.sin(u/2)*Math.sin(u/2);return 6371e3*(2*Math.atan2(Math.sqrt(j),Math.sqrt(1-j)))},E=Object(k.a)((function(e){var t=e.nPlacesToDisplay,n=void 0===t?3:t,a=Object(i.useState)(Object(u.b)(f())),c=Object(s.a)(a,2),r=c[0],o=c[1];Object(u.c)(f(),(function(e){return o(e)}));var l=function(){var e=Object(i.useContext)(I);if(void 0===e)throw new Error('Call "useLocationContext" only inside a LocationContextProvider');return e}().location,j=Object(i.useState)([]),b=Object(s.a)(j,2),d=b[0],x=b[1];return Object(i.useEffect)((function(){if(l){var e=r.stations.slice().sort((function(e,t){return N(l,{lat:e.lat,lon:e.lon})-N(l,{lat:t.lat,lon:t.lon})})).slice(0,n);x(e)}}),[l,n,r.stations]),Object(h.jsx)("div",{children:Object(h.jsx)("div",{style:{display:"flex",flexDirection:"row",flexWrap:"wrap",alignItems:"center",justifyContent:"center"},children:d.map((function(e){return Object(h.jsx)(O.b,{style:{background:"azure",margin:"5px 3px",padding:"3px 5px",borderRadius:"5px",textDecoration:"none",color:"black"},to:"/station/".concat(e.id),children:e.name},e.id)}))})})})),z=n(33),C=n.n(z),T=n(53),M=function(){var e=Object(z.useLocalization)().language,t=T,n=new z.Translator(t,"footer",e);return Object(h.jsxs)("p",{children:[n.getLocaleString("install_to_mobile")," ",Object(h.jsx)(O.b,{to:"/help",children:n.getLocaleString("guide")})]})},F=function(){return Object(h.jsxs)("div",{className:A.a.container,children:[Object(h.jsxs)("div",{className:A.a.header,children:[Object(h.jsx)("img",{src:y,alt:"fillari"}),Object(h.jsx)("u",{style:{color:"darkgreen"},children:Object(h.jsx)("h1",{children:"Omat kaupunkifillarit"})})]}),Object(h.jsxs)("div",{className:A.a.content,children:[Object(h.jsx)(E,{}),Object(h.jsx)(S,{displayHeader:!1}),Object(h.jsx)(x,{})]}),Object(h.jsx)("div",{className:A.a.footer,children:Object(h.jsx)(M,{})})]})},P=n(60),R=n.n(P),H=n(100),D=Object(k.a)((function(){var e=Object(z.useLocalization)().language,t=T,n=new z.Translator(t,"stationInfo",e),a=Object(i.useState)(),c=Object(s.a)(a,2),r=c[0],o=c[1],j=Object(i.useState)(!1),b=Object(s.a)(j,2),d=b[0],x=b[1],p=f(),m=p.addFavorite,v=p.delFavorite,_=Object(i.useState)(Object(u.b)(f())),g=Object(s.a)(_,2),k=g[0],L=g[1];Object(u.c)(f(),(function(e){return L(e)}));var A=Object(l.g)().stationId;Object(i.useEffect)((function(){var e=k.stations.find((function(e){return e.id===A}));if(o(e),r){var t=k.favorites.find((function(e){return e.name===r.name}));x(!!t)}}),[k.favorites,k.stations,r,A]);var I=function(){return k.favorites.length<2?Object(h.jsx)(S,{displayHeader:!1}):Object(h.jsx)("button",{children:Object(h.jsx)(O.b,{to:"/",children:n.getLocaleString("select_other_station")})})};return r?Object(h.jsxs)("div",{className:R.a.container,children:[Object(h.jsxs)("div",{className:R.a.header,children:[Object(h.jsx)(O.b,{to:"/",children:Object(h.jsx)("img",{src:y,alt:"fillari"})}),Object(h.jsxs)("span",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},children:[Object(h.jsx)("h1",{children:r.name}),Object(h.jsx)("i",{onClick:function(){return function(){if(r){var e=k.favorites.find((function(e){return e.name===r.name}));x(!e),e?v(r):m(r)}}()},children:d?Object(h.jsx)(H.b,{size:"32",color:"yellow"}):Object(h.jsx)(H.a,{size:"32"})})]}),Object(h.jsxs)("p",{style:r.active?{color:"greenyellow",margin:0,textAlign:"center",fontSize:"15px"}:{color:"red",textAlign:"center",fontSize:"15px"},children:[n.getLocaleString("station")," ",r.active?n.getLocaleString("in_use"):n.getLocaleString("not_in_use")]})]}),Object(h.jsxs)("div",{className:R.a.bikesAvailable,children:[Object(h.jsx)("div",{className:R.a.len,children:Object(h.jsx)("p",{children:r.bikesAvailable})}),Object(h.jsx)("h1",{style:r.bikesAvailable<1?{color:"#bd0000",textShadow:"2px 2px #b59a9a"}:{color:"snow",textShadow:"2px 2px #61a6e7"},children:n.getLocaleString("n_bikes_available")})]}),Object(h.jsxs)("div",{className:R.a.content,children:[Object(h.jsx)(I,{})," "]}),Object(h.jsx)("div",{className:R.a.footer,children:Object(h.jsx)(M,{})})]}):Object(h.jsx)("div",{children:Object(h.jsx)("p",{children:"NO_DATA"})})})),J=n(113),V=n.n(J),Z=n(16),q=n.n(Z),B=n(114),W=n(115),Y=n(102),G=n(82),K={apiKey:"AIzaSyA0zZzBan7E3YmvAon4l4h7ZOA9hamvlHE",authDomain:"kaupunkifillarit-aed04.firebaseapp.com",projectId:"kaupunkifillarit-aed04",storageBucket:"kaupunkifillarit-aed04.appspot.com",messagingSenderId:"746873844238",appId:"1:746873844238:web:33ffbe49354f2cb420825f",measurementId:"G-S8P5Z3F6S5"},U={getFunctionsInstance:function(){var e=(a||(a=Object(W.a)(K)),Object(Y.b)(a,{provider:new Y.a("6LdyvQYdAAAAAKZD7R1vWhl5PrCyfhHS4zaa6dii"),isTokenAutoRefreshEnabled:!0}));return Object(G.a)(e.app)}},Q=u.d.model("Station",{id:u.d.string,lat:u.d.number,lon:u.d.number,name:u.d.string,bikesAvailable:u.d.number,spacesAvailable:u.d.number,active:u.d.boolean}),X=(u.d.model("Stations",{bikeRentalStations:u.d.array(Q)}),u.d.model("Root",{stations:u.d.array(Q),favorites:u.d.array(Q)}).actions((function(e){return{addFavorite:function(t){e.favorites.find((function(e){return e.name===t.name}))?console.info(t.name,"is allready in favorites"):e.favorites.push(t)},delFavorite:function(t){e.favorites.find((function(e){return e.name===t.name}))?e.favorites.replace(e.favorites.filter((function(e){return e.name!==t.name}))):console.info(t.name,"is not part of favoritelist")},fetchStationDataAsync:Object(u.a)(q.a.mark((function t(){var n,a,i,c;return q.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=U.getFunctionsInstance(),a=B.a(n,"getStationsData",{timeout:7e4}),i=a().then((function(e){return e})),t.next=5,i;case 5:c=t.sent.data,e.stations.replace(c.bikeRentalStations);case 7:case"end":return t.stop()}}),t)})))}}))),$="ROOT_STORE",ee=function(e){var t=e.updateFrequency,n=void 0===t?12e4:t,a=e.children,c=f().fetchStationDataAsync;return Object(i.useEffect)((function(){c();var e=setInterval((function(){console.info("Updating data..."),c()}),n);return function(){return clearInterval(e)}}),[c,n]),Object(h.jsx)("div",{children:a})},te=n(116),ne=n(79),ae=n.n(ne),ie=n(206),ce=n(202),re=n(204),oe=n(203),se=n(101),le=["children","value","index"],ue=function(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}},je=function(e){var t=e.children,n=e.value,a=e.index,i=Object(te.a)(e,le);return Object(h.jsx)("div",Object(p.a)(Object(p.a)({role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},i),{},{children:n===a&&Object(h.jsx)(ie.a,{sx:{p:3},children:Object(h.jsx)(oe.a,{children:t})})}))},be=function(){var e=Object(z.useLocalization)().language,t=T,n=new z.Translator(t,"help",e),a=Object(i.useState)(0),c=Object(s.a)(a,2),r=c[0],o=c[1];return Object(h.jsxs)("div",{className:ae.a.container,children:[Object(h.jsxs)("div",{className:ae.a.header,children:[Object(h.jsx)("img",{src:y,alt:"fillari"}),Object(h.jsx)("h1",{children:"Omat kaupunkifillarit"})]}),Object(h.jsx)("div",{className:ae.a.content,children:Object(h.jsxs)(ie.a,{children:[Object(h.jsxs)(ce.a,{value:r,onChange:function(e,t){o(t)},centered:!0,children:[Object(h.jsx)(re.a,Object(p.a)({icon:Object(h.jsx)(se.a,{size:30}),label:"Android"},ue(0))),Object(h.jsx)(re.a,Object(p.a)({icon:Object(h.jsx)(se.b,{size:30}),label:"iPad tai iPhone"},ue(1)))]}),Object(h.jsx)(je,{value:r,index:0,children:Object(h.jsxs)("ol",{children:[Object(h.jsx)("li",{dangerouslySetInnerHTML:{__html:n.getLocaleString("part_1_chrome")}}),Object(h.jsx)("li",{children:n.getLocaleString("part_2_chrome")}),Object(h.jsx)("li",{dangerouslySetInnerHTML:{__html:n.getLocaleString("part_3_chrome")}})]})}),Object(h.jsx)(je,{value:r,index:1,children:Object(h.jsxs)("ol",{children:[Object(h.jsx)("li",{dangerouslySetInnerHTML:{__html:n.getLocaleString("part_1_safari")}}),Object(h.jsx)("li",{children:n.getLocaleString("part_2_safari")}),Object(h.jsx)("li",{dangerouslySetInnerHTML:{__html:n.getLocaleString("part_3_safari")}})]})})]})}),Object(h.jsx)(O.b,{className:ae.a.back,to:"/",children:n.getLocaleString("exit_guide")})]})},de={FI:"fi",EN:"en"},fe=n(117),Oe=n.n(fe),he=function(){var e=Object(z.useLocalization)().language,t=T,n=new z.Translator(t,"cookieAlert",e);return Object(h.jsxs)(Oe.a,{buttonText:n.getLocaleString("understand"),location:"bottom",visible:"byCookieValue",children:[n.getLocaleString("cookie_message"),Object(h.jsx)("a",{href:"https://policies.google.com/technologies/cookies?hl=".concat(n.getLocaleString("cookie_link_locale")),children:n.getLocaleString("cookie_message_after_link")})]})},xe=function(){var e=Object(i.useState)(),t=Object(s.a)(e,2),n=t[0],a=t[1];return Object(i.useEffect)((function(){a(function(){var e,t,n=u.d.snapshotProcessor(X,{postProcessor:function(e){var t=Object(p.a)({},e);return delete t.Stations,t}});try{var a;t=JSON.parse(null!==(a=localStorage.getItem($))&&void 0!==a?a:"{}"),e=n.create(t)}catch(i){console.error("MST ERROR:",i),e=n.create()}return Object(u.c)(e,(function(e){return localStorage.setItem($,JSON.stringify(e))})),e}())}),[]),n?Object(h.jsx)(d,{value:n,children:Object(h.jsx)(C.a,{languageList:de,defaultLanguage:"FI",children:Object(h.jsx)(w,{children:Object(h.jsx)(ee,{children:Object(h.jsxs)("div",{className:V.a.container,children:[Object(h.jsxs)(l.d,{children:[Object(h.jsx)(l.b,{exact:!0,path:"/",component:F}),Object(h.jsx)(l.b,{exact:!0,path:"/search",component:S}),Object(h.jsx)(l.b,{exact:!0,path:"/station/:stationId",component:D}),Object(h.jsx)(l.b,{exact:!0,path:"/help",component:be})]}),Object(h.jsx)(he,{})]})})})})}):null};o.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(O.a,{children:Object(h.jsx)(xe,{})})}),document.getElementById("root"))},53:function(e){e.exports=JSON.parse('{"FI":{"common":{"app_name":"Omat kaupunkifillarit"},"favorites":{},"help":{"part_1_chrome":"Avaa <b>Omat kaupunkifillarit</b> sovelus <b>Chrome</b> selaimella.","part_2_chrome":"Avaa selaimen valikko (3 pistett\xe4 oikeassa yl\xe4 kulmassa).","part_3_chrome":"Valitse valikosta <b>Lis\xe4\xe4 aloitusn\xe4ytt\xf6\xf6n.</b>","part_1_safari":"Avaa <b>Omat kaupunkifillarit</b> sovelus <b>Safari</b> selaimella.","part_2_safari":"Avaa selaimen pudotusvalikko, selaimen yl\xe4osassa n\xe4kyv\xe4st\xe4 kuvakkeesta jossa laatikosta osoittaa nuoli oikealle.","part_3_safari":"Napauta <b>Lis\xe4\xe4 aloitusn\xe4ytt\xf6\xf6n</b>.","exit_guide":"SULJE OHJE"},"main":{},"nearestPlaces":{},"search":{},"cookieAlert":{"cookie_message":"Omat kaupunkifillarit k\xe4ytt\xe4\xe4 keksej\xe4 paremman k\xe4ytt\xf6kokemuksen luomiseen. Lis\xe4\xe4 tietoa ev\xe4steist\xe4 voit lukea t\xe4\xe4ll\xe4","cookie_message_after_link":"Googlen ev\xe4stek\xe4yt\xe4nt\xf6","cookie_link_locale":"fi-FI","understand":"Ymm\xe4rr\xe4n"},"stationInfo":{"select_other_station":"Valitse toinen asema","station":"Asema","in_use":"on k\xe4yt\xf6ss\xe4","not_in_use":"ei ole k\xe4yt\xf6ss\xe4","n_bikes_available":"Fillaria vapaana"},"footer":{"install_to_mobile":"Asenna mobiilisovellus","guide":"OHJE"}},"EN":{}}')},60:function(e,t,n){e.exports={container:"stationInfo_container__3H6VT",header:"stationInfo_header__151sH",content:"stationInfo_content__1yvd1",footer:"stationInfo_footer__7Nw_g",bikesAvailable:"stationInfo_bikesAvailable__9agL0",len:"stationInfo_len__CjFpV"}},78:function(e,t,n){e.exports={container:"main_container__1Wj1w",header:"main_header__2Ty8i",content:"main_content__IA-9v",footer:"main_footer__1_F-6"}},79:function(e,t,n){e.exports={container:"help_container__lBfRu",header:"help_header__qTCiX",content:"help_content__-xnzE",back:"help_back__2YpZr"}}},[[152,1,2]]]);
//# sourceMappingURL=main.f2dd7106.chunk.js.map